<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Cluster</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="fsl/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="fsl/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="fsl/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">Cluster</a>
</ul>
<br><br>
[<a href="FSL.html">FSL</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867">
<h1 id="Cluster-1">Cluster</h1>
<span class="anchor" id="line-4"></span><p class="line862">The tool <tt class="backtick">cluster</tt> can be used to form clusters, report information about clusters and/or perform cluster-based inference. <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><p class="line862">Cluster formation can be done using <em>any</em> type of image as it uses a supplied threshold, even though the default reporting and input options mention z-stats. Optionally, inference (turning cluster sizes into clusterwise p-values) is done using Gaussian Random Field (GRF) theory and requires smoothness estimates from <tt class="backtick">smoothest</tt>. <span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><p class="line862">The usage for <tt class="backtick">cluster</tt> is: <span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line867"><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><pre><span class="anchor" id="line-1"></span>cluster --in=&lt;filename&gt; --thresh=&lt;value&gt; [options]
<span class="anchor" id="line-2"></span>
<span class="anchor" id="line-3"></span>Compulsory arguments (You MUST set one or more of):
<span class="anchor" id="line-4"></span>        -i,--in,-z,--zstat      filename of input volume
<span class="anchor" id="line-5"></span>        -t,--thresh,--zthresh   threshold for input volume
<span class="anchor" id="line-6"></span>
<span class="anchor" id="line-7"></span>Optional arguments (You may optionally specify one or more of):
<span class="anchor" id="line-8"></span>        -o,--oindex     filename for output of cluster index (in size order)
<span class="anchor" id="line-9"></span>        --othresh       filename for output of thresholded image
<span class="anchor" id="line-10"></span>        --olmax filename for output of local maxima text file
<span class="anchor" id="line-11"></span>        --olmaxim       filename for output of local maxima volume
<span class="anchor" id="line-12"></span>        --osize filename for output of size image
<span class="anchor" id="line-13"></span>        --omax  filename for output of max image
<span class="anchor" id="line-14"></span>        --omean filename for output of mean image
<span class="anchor" id="line-15"></span>        --opvals        filename for image output of log pvals
<span class="anchor" id="line-16"></span>        -p,--pthresh    p-threshold for clusters
<span class="anchor" id="line-17"></span>        --peakdist      minimum distance between local maxima/minima, in mm (default 0)
<span class="anchor" id="line-18"></span>        -c,--cope       filename of input cope volume
<span class="anchor" id="line-19"></span>        --volume        number of voxels in the mask
<span class="anchor" id="line-20"></span>        -d,--dlh        smoothness estimate = sqrt(det(Lambda))
<span class="anchor" id="line-21"></span>        --fractional    interprets the threshold as a fraction of the robust range
<span class="anchor" id="line-22"></span>        --connectivity  the connectivity of voxels (default 26)
<span class="anchor" id="line-23"></span>        --mm    use mm, not voxel, coordinates
<span class="anchor" id="line-24"></span>        --min   find minima instead of maxima
<span class="anchor" id="line-25"></span>        --no_table      suppresses printing of the table info
<span class="anchor" id="line-26"></span>        --minclustersize        prints out minimum significant cluster size
<span class="anchor" id="line-27"></span>        -x,--xfm        filename for Linear: input-&gt;standard-space transform. Non-linear: input-&gt;highres transform
<span class="anchor" id="line-28"></span>        --stdvol        filename for standard-space volume
<span class="anchor" id="line-29"></span>        --scalarname    give name of scalars (e.g. Z) - to be used in printing output tables
<span class="anchor" id="line-30"></span>        -n,--num        no of local maxima to report
<span class="anchor" id="line-31"></span>        -v,--verbose    switch on diagnostic messages
<span class="anchor" id="line-32"></span>        -h,--help       display this message
<span class="anchor" id="line-33"></span>        --warpvol       filename for warpfield</pre><span class="anchor" id="line-45"></span><p class="line867">
<h2 id="Outputs">Outputs</h2>
<span class="anchor" id="line-46"></span><p class="line862">The main output from cluster is the table reporting the different clusters, their size, and information about their location and contents (e.g. maximum/mean values within the cluster).  This table is written as plain text and is output to the screen, but can be redirected into a file using the standard unix method of using &quot;<tt class="backtick">&gt;&nbsp;filename</tt>&quot; after the command (which puts all the output that would have been written to the screen into the specified file instead) - see examples below. <span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><p class="line874">The standard output table contains the following columns: <span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><p class="line867"><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><pre><span class="anchor" id="line-1-1"></span>Cluster Index   Voxels  MAX     MAX X (vox)     MAX Y (vox)     MAX Z (vox)     COG X (vox)     COG Y (vox)     COG Z (vox)</pre><span class="anchor" id="line-53"></span><ul><li>Cluster Index: a unique number for each cluster from 1 to N (larger clusters have bigger numbers) <span class="anchor" id="line-54"></span></li><li>Voxels: the number of voxels in the cluster <span class="anchor" id="line-55"></span></li><li>MAX: the value of the maximum &quot;intensity&quot; within the cluster (e.g. the maximum z-statistic if the input was a z-statistic image) <span class="anchor" id="line-56"></span></li><li><p class="line862">MAX X/Y/Z (vox/mm): the location of the maximum intensity voxel, given as X/Y/Z coordinate values in either voxel coordinates (vox) or standard space coordinates (mm) - the latter requires either the input image to already be in standard space or a transformation to standard space to be specified via the options <tt class="backtick">-x,--xfm</tt> or <tt class="backtick">--warpvol</tt> <span class="anchor" id="line-57"></span></li><li>COG X/Y/Z (vox/mm): the location of the Centre Of Gravity for the cluster (that is, a weighted average of the coordinates by the intensities within the cluster, equivalent to the concept of Centre Of Gravity for a object with distributed mass, where intensity substitutes for mass in this case) <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span></li></ul><p class="line874">Note that the text formatting of the columns can make it difficult to see which header is attached to which column of numbers, so be careful to count the columns correctly. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line862">If a COPE image is added (<tt class="backtick">-c,--cope</tt>) then extra columns are added to the table, reporting the maximum COPE value, the location of this maximum and the mean COPE value over the <em>clusters defined from the input image</em> (i.e., clusters are not defined using the COPE image). <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><p class="line862">If GRF options are added (<tt class="backtick">-d,--dlh</tt> and <tt class="backtick">--volume</tt> and <tt class="backtick">-p,--pthresh</tt>) then the table also reports the probability (p-value and -log10(p)) associated with each cluster. <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line862">Some particularly useful <em>image</em> outputs are: <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><ul><li><p class="line862">cluster index (<tt class="backtick">--oindex</tt> or <tt class="backtick">-o</tt>): this is an image where every cluster is assigned a unique number (from 1 to N) and the intensity of every voxel in a cluster is set to this unique number.  For example, every voxel in cluster number 3 will have an intensity of 3.  This is very useful for separating/extracting clusters - see the examples below. <span class="anchor" id="line-68"></span></li><li><p class="line862">size index (<tt class="backtick">--osize</tt>): every voxel in a cluster has its intensity set equal to the size of that cluster (where size is the number of voxels).  This is useful for thresholding clusters based on size. <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span></li></ul><p class="line867">
<h2 id="Examples">Examples</h2>
<span class="anchor" id="line-71"></span><p class="line862">The examples below represent a small set of possibilities, but include the most commonly used scenarios.  Note that most of the commands below redirect the text output into a file, but the text output can be displayed directly on the screen by deleting everything from the &quot;<tt class="backtick">&gt;</tt>&quot; character and onwards. <span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><p class="line867">
<h3 id="Defining_Clusters">Defining Clusters</h3>
<span class="anchor" id="line-74"></span><p class="line867"><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><pre><span class="anchor" id="line-1-2"></span>    cluster -i myinputimage -t 2.5 -o cluster_index --osize=cluster_size &gt; cluster_info.txt</pre><span class="anchor" id="line-77"></span><p class="line862">This takes any type of input values (contained in the image file <tt class="backtick">myinputimage</tt>) and thresholds them at 2.5 (a totally arbitrary example value here).  The output images specified here are two of the most useful outputs, as described above, although other outputs can also be requested. <span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line867">
<h3 id="Extracting_a_Particular_Cluster">Extracting a Particular Cluster</h3>
<span class="anchor" id="line-80"></span><p class="line862">Assuming that a cluster index file has been created (e.g., as above) then any particular cluster can be extracted using <tt class="backtick">fslmaths</tt>.  For example, to extract a mask that contained only cluster number 7 we would do: <span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><p class="line867"><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><pre><span class="anchor" id="line-1-3"></span>    fslmaths -dt int cluster_index -thr 7 -uthr 7 -bin cluster_mask7</pre><span class="anchor" id="line-85"></span><p class="line867"><span class="anchor" id="reporting"></span> <span class="anchor" id="line-86"></span>
<h3 id="Reporting_Cluster_Information">Reporting Cluster Information</h3>
<span class="anchor" id="line-87"></span><ul><li>Z-stat (without GRF statistics): <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span></li></ul><p class="line867"><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><pre><span class="anchor" id="line-1-4"></span>    cluster -i zstat1 -t 2.3 &gt; cluster_zstat1.txt</pre><span class="anchor" id="line-92"></span><ul><li style="list-style-type:none">Note: the threshold value of 2.3 is an arbitrary example only. <span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-95"></span><ul><li><p class="line862">Corrected 1-p values (as output from <tt class="backtick">randomise</tt>): <span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span></li></ul><p class="line867"><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><pre><span class="anchor" id="line-1-5"></span>    cluster -i blah_blah_corrp_tstat1 -t 0.95 --scalarname=&quot;1-p&quot; &gt; cluster_corrp1.txt</pre><span class="anchor" id="line-100"></span><ul><li style="list-style-type:none"><p class="line862">Notes: the threshold is based on the 1-p value (i.e. 0.95 = 1 - 0.05); the use of <tt class="backtick">--scalarname</tt> means that all the table headings report &quot;1-p&quot; rather than &quot;Z&quot;. <span class="anchor" id="line-101"></span></li><li style="list-style-type:none"><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-104"></span><ul><li><p class="line862">Corrected 1-p values with associated t-statistics (as output from <tt class="backtick">randomise</tt>): <span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span></li></ul><p class="line867"><span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><pre><span class="anchor" id="line-1-6"></span>    cluster -i blah_blah_corrp_tstat1 -t 0.95 -c blah_blah_tstat1 --scalarname=&quot;1-p&quot; &gt; cluster_corrp1.txt</pre><span class="anchor" id="line-109"></span><ul><li style="list-style-type:none"><p class="line862">Note: the columns labelled <tt class="backtick">COPE</tt> refer to the associated t-statistics within the respective clusters (where the clusters are still defined by the 1-p values in the input image, together with the threshold) <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-112"></span><ul><li>Z-stat with GRF statistics: <span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span></li></ul><p class="line867"><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><pre><span class="anchor" id="line-1-7"></span>    cluster -i zstat1 -t 2.3 -p 0.05 -d 1.65786 --volume=19537 &gt; cluster_zstat1.txt</pre><span class="anchor" id="line-117"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-118"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2017-04-20 13:23
</body>
</html>
