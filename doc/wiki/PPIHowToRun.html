<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>PPIHowToRun</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="fsl/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="fsl/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="fsl/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">PPIHowToRun</a>
</ul>
<br><br>
[<a href="FSL.html">FSL</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867">
<h1 id="How_to_run_a_PPI_analysis_in_Feat">How to run a PPI analysis in Feat</h1>
<span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line867"><strong>Instructions for implementing a PPI analysis with the Feat gui.</strong> <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867"><a href="./PPIFAQ.html">See also: Frequently Asked Questions (PPI)</a> <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line867">
<h2 id="A1._Make_some_decisions">1. Make some decisions</h2>
<span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><p class="line874">Because you start by choosing and ROI and task contrast, PPI is heavily <span class="anchor" id="line-14"></span>hypothesis driven. If you don’t have a clear hypothesis about functional <span class="anchor" id="line-15"></span>connectivity, you might consider using a model-free approach like MELODIC, <span class="anchor" id="line-16"></span>which also gives you ‘network’ information of a different kind. On the other <span class="anchor" id="line-17"></span>hand, you can also try running lots of different PPIs with different seed <span class="anchor" id="line-18"></span>regions until you find something interesting…. <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><p class="line867">
<h3 id="Choose_your_ROI">Choose your ROI</h3>
<span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line874">For a PPI analysis, you must select a seed Region of Interest (ROI) – the <span class="anchor" id="line-25"></span>point of the analysis is to look for areas which ‘interact’ with this seed <span class="anchor" id="line-26"></span>region. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line874">There are several types of ROI you might go for: <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><ul><li><p class="line891"><strong>An anatomical region of interest.</strong> For example, you might have an a priori hypothesis about the functional connectivity, in your task, of the hippocampus, or the putamen, or some other region which you can define from a structural scan. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span></li><li class="gap"><p class="line891"><strong>An ROI based on functional activations from your initial GLM (Feat) analysis.</strong>  For example, you might find a few blobs associated with your task of interest, and you hypothesis that these blobs can be grouped into a couple of separate networks. Maybe you were doing a memory task, and it activated the hippocampus. You have some idea what the hippocampus is doing, so now you want to know which areas have increased functional connectivity with it during your task, and which areas are involved, but not interacting with the hippocampus. <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span></li><li class="gap"><p class="line891"><strong>An ROI based on a local maximum in one of your MELODIC components.</strong> For example, say you analyzed your data with group-MELODIC and you found the two biggest components were, say, an attentional (dorsal, frontal-parietal) network and a memory network (say, prefrontal and medial temporal areas). And say your experiment looked at how your memories can bias your attention, comparing trials with familiar stimuli and novel stimuli. Then the attention and memory networks might describe the two major cognitive components of your whole dataset (all trials together) - but for you the critical point of interest is whether there is more interaction between networks in your attention-from-memory task. You can pick a blob from one of your melodic components, which you think might be the 'linking' node, and use it as the seed for a PPI, which tells you about task-specific interactions.  Note that MELODIC blobs may be more likely to be 'good' seeds for your PPI analysis than GLM/Feat blobs, because MELODIC is a more network-oriented type of analysis. <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span></li></ul><p class="line867">
<h3 id="Choose_your_task_contrast">Choose your task contrast</h3>
<span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line874">PPI analysis always looks for voxels with increased functional connectivity to <span class="anchor" id="line-42"></span>your seed ROI in one condition compared to another. Usually, the contrast will <span class="anchor" id="line-43"></span>be between conditions within a single scanning session, and you need to decide <span class="anchor" id="line-44"></span>whether this will be a contrast of one condition vs everything else (a 1 0 <span class="anchor" id="line-45"></span>contrast) or a contrast between two conditions (a 1 -1 contrast). More details <span class="anchor" id="line-46"></span>about this are in the <a href="./PPIFAQ.html">FAQ</a>. <span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><p class="line874">However, you may also be interested in comparing between scanning sessions, <span class="anchor" id="line-50"></span>for example before and after an intervention, such as a drug or brain <span class="anchor" id="line-51"></span>stimulation - or even betweens groups (e.g. patients vs. controls). A <span class="anchor" id="line-52"></span>discussion of between-subjects designs can be found <a href="./PPI.html">here</a>. <span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><p class="line867">
<h2 id="A2._Prepare_your_regressors">2. Prepare your regressors</h2>
<span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><p class="line874">You need to extract the timecourse from the seed ROI and put it into a format <span class="anchor" id="line-59"></span>which Feat can read, before using Feat to make your PPI regressor. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><p class="line867">
<h3 id="Make_masks_for_the_seed_ROI">Make masks for the seed ROI</h3>
<span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line874">You need to make a mask for your seed region in each individual subject’s <span class="anchor" id="line-66"></span>functional native space (that is, the space of the fMRI image you want to <span class="anchor" id="line-67"></span>analyse). <span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line867">
<h4 id="Anatomical_region_of_interest">Anatomical region of interest</h4>
<span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><p class="line874">Your options are: <span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><ul><li>Draw a mask on individuals’ structural scans with Fslview <span class="anchor" id="line-76"></span></li><li>Draw a mask on the standard brain and transforming it into individual space using FLIRT or FNIRT <span class="anchor" id="line-77"></span></li><li>Use an automated segmentation tool eg FIRST. <span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span></li></ul><p class="line867">
<h4 id="Functional_region_of_interest">Functional region of interest</h4>
<span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><p class="line874">Your options are: <span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><ul><li>On your group Feat results/ MELODIC component, draw a region of interest  over the blob you are interested in. Transform this into the functional space of each individual using FLIRT or FNIRT. Check, for each individual, that your ROI is a sensible size and is contained within the brain and within the anatomical region of interest (if your ROI is near the surface and ends up lapping over the edge of the brain in some subjects, your timecourse data will be very noisy, so you really do need to check). <span class="anchor" id="line-85"></span></li><li>Go to each individual subject's Feat results and pick the peak voxel in the region of interest. Draw a small mask surrounding this peak voxel. <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span></li></ul><p class="line874">This may be a more successful strategy when the functional regions are <span class="anchor" id="line-88"></span>anatomically heterogeneous but functionally well defined, e.g. in the parietal <span class="anchor" id="line-89"></span>cortex. <span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><p class="line867">
<h4 id="Size_of_ROIs">Size of ROIs</h4>
<span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><p class="line874">If you are defining ROIs individually (as in the second functional-ROI case, <span class="anchor" id="line-96"></span>or some of the anatomical cases) you analysis will likely work better (have <span class="anchor" id="line-97"></span>higher signal-to-noise) if you <strong>keep the ROI small</strong>. This is because you <span class="anchor" id="line-98"></span>are only taking one measurement from the whole ROI – so by enlarging the ROI <span class="anchor" id="line-99"></span>to include voxels with a weaker effect you are actually ‘watering down’ the <span class="anchor" id="line-100"></span>signal. <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><p class="line874">On the other hand, if you are using a standard-space mask (as in the first <span class="anchor" id="line-104"></span>functional-ROI strategy), you will want to make sure your ROI is <strong>large <span class="anchor" id="line-105"></span>enough to capture the individual activation peak</strong> for each subject, despite <span class="anchor" id="line-106"></span>inter-individual variations. <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><p class="line867">
<h3 id="Extract_the_time-course_of_the_seed_ROI">Extract the time-course of the seed ROI</h3>
<span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><p class="line874">Do this for each subject separately, using the fslmeants command. <span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><p class="line874">You should use the filtered func data from your initial analysis to extract <span class="anchor" id="line-116"></span>the timecourse from - not the raw data as this will be noisy. <span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span><pre><span class="anchor" id="line-1"></span>fslmeants -i filtered_func.nii.gz -o my_timecourse.txt -m your_roi_mask.nii.gz</pre><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span></li></ul><p class="line874">The output is a column vector giving a value of raw signal at each time-point; <span class="anchor" id="line-124"></span>there is one time-point per volume. The time-course is saved under a filename <span class="anchor" id="line-125"></span>specified by you, for use later on. <span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><p class="line867">
<h2 id="A3._Set_up_your_Feat_design">3. Set up your Feat design</h2>
<span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><ul><li>Go into Feat and load your data and set up your pre-processing as normal <span class="anchor" id="line-132"></span></li><li>If you are using the filtered_func from your GLM analysis as input, remember not to re-do any pre-processing steps such as BET, deleting volumes, or filtering. <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span></li></ul><p class="line867">
<h4 id="In_the_stats_tab">In the stats tab</h4>
<span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><p class="line874">You will need the following regressors: <span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><p class="line867"><strong>EV1 is your psychological regressor</strong> (PSY). This will simply be your task <span class="anchor" id="line-142"></span>regressor, convolved with an HRF; <span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><p class="line867"><strong>EV2 is your physiological regressor</strong> (PHYS). This will be the time-course of your seed ROI:  <span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><ul><li><p class="line862">Basic shape is ‘custom (1 entry per volume)’ and the input file is the time-course from the seed region, which you generated earlier with <em>fslmeants</em>. <span class="anchor" id="line-148"></span></li><li><p class="line862">Set <strong>convolution to none</strong> because this is BOLD data and has already been convolved by the brain! <span class="anchor" id="line-149"></span></li><li><p class="line862">Switch off <strong>temporal derivative</strong> and <strong>temporal filtering</strong> <span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span></li></ul><p class="line867"><strong>EV3 is PPI</strong>, which you generate here in the Feat GUI;  <span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><ul><li><p class="line891"><strong>Basic shape</strong> is ‘interaction’ <span class="anchor" id="line-154"></span></li><li><p class="line891"><strong>Between EVs</strong>: select EV1 and EV2 <span class="anchor" id="line-155"></span></li><li><p class="line891"><strong>Make zero</strong> - these drop down boxes give you the choice of Min, Centre and Mean. You should choose <span class="anchor" id="line-156"></span><ul><li><p class="line891"><strong>centre</strong> for your task (PSY) EV, and  <span class="anchor" id="line-157"></span></li><li><p class="line891"><strong>mean</strong> for your ROI timecourse (PHYS) EV. <span class="anchor" id="line-158"></span></li><li><p class="line891"><a href="./PPIZeroing.html">Read more about the zero-ing options here.</a> <span class="anchor" id="line-159"></span></li></ul></li><li><p class="line891"><strong>Orthogonalise</strong>: You should probably not do this.  If in doubt, have a look at the notes on orthogonalizing in the main Feat page and the FSL course.  Effectively, orthogonalizing means that the stats for the EV you orthogonalize <em>with respect to</em> (<strong>not</strong> the EV where you click the 'orthogonalize' button) change. Why? Because in the GLM, if some activity in your voxel is correlated with BOTH EVs A and B, is is not assigned to either. Now, If A and B are partially correlated (eg if they are your PSY and PPI) then some activity in some voxels may be correlated with the correlated part of A and B. This activity is therefore assigned to neither A nor B. Orthogonalizing B with respect to A changes regressor B, to remove the part which was correlated with A. This means that the activity which was correlated with both A and B, which was previously not modelled, is now only correlated with A - so the estimate for EV A changes. The esitmate for EV B stays the same, because you have only taken away the part of that EV which was correlated with A, and therefore didn't get any activity assigned to it anyway. Now, in Feat you always orthogonalize the later-created EV w.r.t. the earlier-created one, and the PPI EV will necessarily be created after the task EV- So if you were to orthogonalise your PPI EV with respect to your task EV, the effect of orthogonalizing would be on the results for the main effect of task, not on the PPI effect. <span class="anchor" id="line-160"></span></li><li><p class="line862">Switch off <strong>temporal derivative</strong> and <strong>temporal filtering</strong> <span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><ul><li style="list-style-type:none"><p class="line891"><img alt="PPI within subjects setup" class="attachment" src="attachments/PPIHowToRun/PPI_setup_within_subjects_design.png" title="PPI within subjects setup" /> <span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span></li></ul></li><li class="gap"><p class="line891"><strong>Other task regressors</strong> As well as the three EVs described here, you should include all the task EVs you included in your original model, in the setup for the PPI analysis. So your setup should look like the setup for your original (standard) Feat analysis, but with the physiological and PPI regressors added. The model describes the data better if all task EVs are included. <span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span></li></ul><p class="line874">This completes the set-up for the first-level analysis. You can then compare <span class="anchor" id="line-168"></span>between groups at the second level as normal. <span class="anchor" id="line-169"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2017-04-20 13:28
</body>
</html>
