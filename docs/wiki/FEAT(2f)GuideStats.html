<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>FEAT/GuideStats</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="fsl/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="fsl/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="fsl/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">FEAT/GuideStats</a>
</ul>
<br><br>
[<a href="FSL.html">FSL</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><p class="line867"><div class="FslToolContents">
<h1>Contents</h1>
<ol><li><a href="./FEAT.html">Introduction</a></li><li><a href="./FEAT(2f)UserGuide.html">User Guide</a></li><li><a href="./FEAT(2f)FAQ.html">FAQ</a></li></ol></div> <span class="anchor" id="line-3"></span>
<h1 id="Stats_.28First-level.29">Stats (First-level)</h1>
<span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
<h2 id="FILM_General_Linear_Model">FILM General Linear Model</h2>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line862">General linear modelling allows you to describe one or more stimulation types, and, for each voxel, a linear combination of the modelled response to these stimulation types is found which minimises the unmodelled noise in the fitting. If you are not familiar with the concepts of the GLM and contrasts of parameter estimates, then you should now read <a href="./FEAT(2f)GuideStats.html#Appendix_A:_Brief_Overview_of_GLM_Analysis">Appendix A</a>. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line862">For normal first-level time series analysis you should <strong>Use FILM prewhitening</strong> to make the statistics valid and maximally efficient. For other data - for example, very long TR (&gt;30s) FMRI data, PET data or data with very few time points (&lt;50) - this should be turned off. <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line874">You may want to include the head motion parameters (as estimated by MCFLIRT motion correction in the Pre-stats processing) as confound EVs in your model. This can sometimes help remove the residual effects of motion that are still left in the data even after motion correction. This is not strongly recommended as there is still much to learn about residual motion effects; simply adding such confound EVs is quite a simplistic solution. We would recommend instead turning on MELODIC in the FEAT Pre-stats and using ICA-based denoising as a better alternative to removing residual motion effects (see the FEAT manual for more information on that). However, if you do wish to include motion parameters in your model then select this option. If you do this, then once the motion correction has been run, the translation and rotation parameters are added as extra confound EVs in the model. If you select this option then only the components of the main EVs that are orthogonal to the motion confound EVs will be used in determining significance of the effects of interest. You cannot use this option unless you are carrying out both pre-stats and stats in the same FEAT run. <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><p class="line862">If you want to add other confound EVs than motion parameters, that you have precomputed for your data, then turn the <strong>Add additional confound EVs</strong> option on and then enter the filename of a raw text file (or, if you are setting up multiple analyses, enter one text file for each input FMRI dataset to be processed). The file can contain as many confound EVs as you like, each in a separate column in the text file. <span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><p class="line862">You can setup FILM easily for simple designs by pressing the <strong>Model setup wizard</strong> button. At first level, the options are regular rest-A-rest-A... or rest-A-rest-B-rest-A-rest-B... designs (block or single-event) for normal BOLD FMRI, or a rest-A-rest-A... design for full modelling of perfusion FMRI data. At second level, the options are one-group t-test, two-group-unpaired and two-group-paired t-tests. Then, in the wizard popup window, choose whether to setup <strong>rArA</strong>... or <strong>rArBrArB</strong>... designs (regular block or single-event). The r blocks will normally be rest (or control) conditions. The <strong>perfusion rArA</strong>... option sets up the full model for a simple perfusion experiment, setting up a constant-height control-tag EV, an average BOLD component EV and the interaction EV, which represents the control-tag functional modulation (see the <a href="./FEAT(2f)GuideStats.html#Perfusion">Perfusion</a> section of the manual for more information on this). Next, press Process and the model will be setup for you. If you want to setup a more complex model, or adjust the setup created by the wizard, press <strong>Full model setup</strong> button. This is now described in detail. <span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line867">
<h2 id="EVs">EVs</h2>
<span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line862">First set the <strong>Number of original EVs</strong> (explanatory variables) - basic number of explanatory variables in the design matrix; this means the number of different effects that you wish to model - one for each modelled stimulation type, and one for each modelled confound. For first-level analyses, it is common for the final design matrix to have a greater number of <strong>real EVs</strong> than this <strong>original</strong> number; for example, when using basis functions, each original EV gives rise to several <strong>real EVs</strong>. <span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><p class="line874">Now you need to setup each EV separately. Choose the basic shape of the waveform that describes the stimulus or confound that you wish to model. The basic waveform should be exactly in time with the applied stimulation, i.e., not lagged at all. This is because the measured (time-series) response will be delayed with respect to the stimulation, and this delay is modelled in the design matrix by convolution of the basic waveform with a suitable haemodynamic response function (see below). <span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><p class="line862">If you need an EV to be ignored, choose <strong>Empty (all zeros)</strong>. You are most likely to want to do this if you want the EVs to all have the same meaning for multiple runs, but in some runs one or more EVs contain no events of the relevant type. Note that in this case you will get a warning about the matrix being rank deficient. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line862">For an on/off (or a regularly-spaced single-event) experiment choose a <strong>square</strong> wave. To model single-event experiments with this method, the <strong>On</strong> periods will probably be small - e.g., 1s or even less. <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><p class="line862">For sinusoidal modelling choose the <strong>Sinusoid</strong> option and select the number of <strong>Harmonics</strong> (or overtones) that you want to add to the fundamental frequency. <span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line862">For a single-event experiment with irregular timing for the stimulations, a custom file can be used. With <strong>Custom (1 entry per volume)</strong>, you specify a single value for each timepoint. The custom file should be a raw text file, and should be a list of numbers, separated by spaces or newlines, with one number for each volume (after subtracting the number of deleted images). These numbers can either all be 0s and 1s, or can take a range of values. The former case would be appropriate if the same stimulus was applied at varying time points; the latter would be appropriate, for example, if recorded subject responses are to be inserted as an effect to be modelled. Note that it may or may not be appropriate to convolve this particular waveform with an HRF - in the case of single-event, it is. <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><p class="line862">For even finer control over the input waveform, choose <strong>Custom (3 column format)</strong>. In this case the custom file consists of triplets of numbers; you can have any number of triplets. Each triplet describes a short period of time and the value of the model during that time. The first number in each triplet is the onset (in seconds) of the period, the second number is the duration (in seconds) of the period, and the third number is the value of the input during that period. The same comments as above apply, about whether these numbers are 0s and 1s, or vary continuously. The start of the first non-deleted volume correpsonds to t=0. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><p class="line874">Note that whilst ALL columns are demeaned before model fitting, neither custom format will get rescaled - it is up to you to make sure that relative scaling between different EVs is sensible. If you double the scaling of values in an EV you will halve the resulting parameter estimate, which will change contrasts of this EV against others. <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line862">If you select <strong>Interaction</strong> then the current EV is modelled as an interaction between other EVs, and is normally used to create a third EV from two existing EVs, to model the nonlinear interaction between two different conditions (or for a Psycho-Physiological Interaction, or PPI, analysis). On the line of buttons marked <strong>Between EVs</strong> you select which other EVs to interact to form the new one. The selected EVs then get multiplied together to form the current EV. Normally they are multiplied after (temporarily) shifting their values so that the minimum of each EV is zero (<strong>Make zero = Min</strong>); however, if you change the <strong>Make zero</strong>: option, individual EVs will instead be zero-centred about the min and max values (<strong>Centre</strong>) or de-meaned (<strong>Mean</strong>). If all EVs feeding into an interaction have the same convolution settings, the interaction is calculated before convolutions, and the same convolution applied to the interaction; if they do not all have the same settings, then all convolutions are applied before forming the interaction, and no further convolution is applied to the interaction EV. <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><p class="line862">For PPI analyses, you should probably do something like: Set EV1 to your main effect of interest, set EV2 to your data-derived regressor (with convolution turned off for EV2), and set EV3 to be an <strong>Interaction</strong>. EV3 would then be an interaction between EV1 and EV2, with EV1's zeroing set to <strong>Centre</strong> and EV2's zeroing set to <strong>Mean</strong>. For more detail on PPI analyses in theory and in practice, see <a class="http" href="http://www.fmrib.ox.ac.uk/Members/joreilly/what-is-ppi">Jill O'Reilly's PPI</a> page. <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line862">If you have chosen a <strong>Square</strong> or <strong>Sinusoid</strong> basic shape, you then need to specify what the timings of this shape are. <strong>Skip</strong> is the initial period of zeros (in seconds) before the waveform commences. <strong>Off</strong> is the duration (seconds) of the &quot;Off&quot; periods in the square wave. <strong>On</strong> is the duration (seconds) of the &quot;On&quot; periods in the square wave. <strong>Period</strong> is the period (seconds) of the <strong>Sinusoid</strong> waveform. <strong>Phase</strong> is the phase shift (seconds) of the waveform; by default, after the <strong>Skip</strong> period, the square wave starts with a full <strong>Off</strong> period and the <strong>Sinusoid</strong> starts by falling from zero. However, the wave can be brought forward in time according to the phase shift. Thus to start with half of a normal <strong>Off</strong> period, enter the <strong>Phase</strong> as half of the <strong>Off</strong> period. To start with a full On period, enter the same as the <strong>Off</strong> period. <strong>Stop after</strong> is the total duration (seconds) of the waveform, starting after the <strong>Skip</strong> period. &quot;-1&quot; means do not stop. After stopping a waveform, all remaining values in the model are set to zero. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line867"><strong>Convolution</strong> sets the form of the HRF (haemodynamic response function) convolution that will be applied to the basic waveform. This blurs and delays the original waveform, in an attempt to match the difference between the input function (original waveform, i.e., stimulus waveform) and the output function (measured FMRI haemodynamic response). If the original waveform is already in an appropriate form, e.g., was sampled from the data itself, <strong>None</strong> should be selected. The next three options are all somewhat similar blurring and delaying functions. <strong>Gaussian</strong> is simply a Gaussian kernel, whose width and lag can be altered. <strong>Gamma</strong> is a Gamma variate (in fact a normalisation of the probability density function of the Gamma function); again, width and lag can be altered. <strong>Double-Gamma HRF</strong> is a preset function which is a mixture of two Gamma functions - a standard positive function at normal lag, and a small, delayed, inverted Gamma, which attempts to model the late undershoot. <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line862">The remaining convolution options setup different <strong>basis functions</strong>. This means that the original EV waveform will get convolved by a &quot;basis set&quot; of related but different convolution kernels. By default, an <strong>original EV</strong> will generate a set of <strong>real EVs</strong>, one for each basis function. <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line862">The <strong>Optimal/custom</strong> option allows you to use a customised set of basis functions, setup in a plain text file with one column for each basis function, sampled at the temporal resolution of 0.05s. The main point of this option is to allow the use of &quot;FLOBS&quot; (FMRIB's Linear Optimal Basis Set), which is a method for generating a set of basis functions that has optimal efficiency in covering the range of likely HRF shapes actually found in your data. You can either use the default FLOBS set, or use the <strong>Make_flobs</strong> GUI on the FEAT <strong>Utils</strong> menu to create your own customised set of FLOBS. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><p class="line862">The other basis function options, which will not in general be as good at fitting the data as FLOBS, are a set of <strong>Gamma</strong> variates of different widths and lags, a set of <strong>Sine</strong> waves of differing frequencies or a set of <strong>FIR</strong> (finite-impulse-response) filters (with FIR the convolution kernel is represented as a set of discrete fixed-width &quot;impulses&quot;). <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><p class="line862">For all basis function options there is the option to force exact orthogonalisation of the functions with respect to each other. For basis functions which are generally expected to be orthogonal (normally just) the <strong>Optimal/custom</strong> option) this option should normally be left on, otherwise you would normally expect to leave it turned off. <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line862">You should normally apply the same temporal filtering to the model as you have applied to the data, as the model is designed to look like the data before temporal filtering was applied. In this way, long-time-scale components in the model will be dealt with correctly. This is set with the <strong>Apply temporal filtering</strong> option. <span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><p class="line862">Adding a fraction of the temporal derivative of the blurred original waveform is equivalent to shifting the waveform slightly in time, in order to achieve a slightly better fit to the data. Thus adding in the temporal derivative of a waveform into the design matrix allows a better fit for the whole model, reducing unexplained noise, and increasing resulting statistical significances. Thus, setting <strong>Add temporal derivative</strong> produces a new waveform in the final design matrix (next to the waveform from which it was derived) This option is not available if you are using basis functions. <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><p class="line867"><strong>Orthogonalising</strong> an EV with respect to other EVs means that it is completely independent of the other EVs, i.e. contains no component related to them. Most sensible designs are already in this form - all EVs are at least close to being orthogonal to all others. However, this may not be the case; you can use this facility to force an EV to be orthogonal to some or all other EVs. This is achieved by subtracting from the EV that part which is related to the other EVs selected here. An example use would be if you had another EV which was a constant height spike train, and the current EV is derived from this other one, but with a linear increase in spike height imposed, to model an increase in response during the experiment for any reason. You would not want the current EV to contain any component of the constant height EV, so you would orthogonalise the current EV wrt the other. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><p class="line867">
<h3 id="Contrasts">Contrasts</h3>
<span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><p class="line874">Each EV (explanatory variable, i.e., waveform) in the design matrix results in a PE (parameter estimate) image. This estimate tells you how strongly that waveform fits the data at each voxel - the higher it is, the better the fit. For an unblurred square wave input (which will be scaled in the model from -0.5 to 0.5), the PE image is equivalent to the &quot;mean difference image&quot;. To convert from a PE to a t statistic image, the PE is divided by its standard error, which is derived from the residual noise after the complete model has been fit. The t image is then transformed into a Z statistic via standard statistical transformation. As well as Z images arising from single EVs, it is possible to combine different EVs (waveforms) - for example, to see where one has a bigger effect than another. To do this, one PE is subtracted from another, a combined standard error is calculated, and a new Z image is created. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line862">All of the above is controlled by you, by setting up contrasts. Each output Z statistic image is generated by setting up a contrast vector; thus set the number of outputs that you want, using <strong>Number of contrasts</strong>. To convert a single EV into a Z statistic image, set its contrast value to 1 and all others to 0. Thus the simplest design, with one EV only, has just one contrast vector, and only one entry in this contrast vector; 1. To add more contrast vectors, increase the <strong>Number of contrasts</strong>. To compare two EVs, for example, to subtract one stimulus type (EV1) from another type (EV2), set EV1's contrast value to -1 and EV2's to 1. A Z statistic image will be generated according to this request. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><p class="line862">For first-level analyses, it is common for the final design matrix to have a greater number of <strong>real EVs</strong> than the <strong>original</strong> number; for example, when using basis functions, each <strong>original EV</strong> gives rise to several <strong>real EVs</strong>. Therefore it is possible in many cases for you to setup contrasts and F-tests with respect to the original EVs, and FEAT will work out for you what these will be for the final design matrix. For example, a single [1] contrast on an original EV for which basis function HRF convolutions have been chosen will result in a single [1] contrast for each resulting real EV, and then an F-test across these. In general you can switch between setting up contrasts and F-tests with respect to <strong>Original EVs</strong> and <strong>Real EVs</strong>; though of course if you fine-tune the contrasts for real EVs and then revert to original EV setup some settings may be lost. When you <strong>View</strong> the design matrix or press <strong>Done</strong> at the end of setting up the model, an <strong>Original EVs</strong> setup will get converted to the appropriate <strong>Real EVs</strong> settings. <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line862">An important point to note is that you should <strong>not</strong> test for differences between different conditions (or at higher-level, between sessions) by looking for differences between their separate individual analyses. One could be just above threshold and the other just below, and their difference might not be significant. The correct way to tell whether two conditions or session's analyses are significantly different is to run a differential contrast like [1 -1] between them (or, at higher-level, run a higher-level FEAT analysis to contrast lower-level analyses); this contrast will then get properly thresholded to test for significance. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><p class="line862">There is another important point to note when interpreting differential (eg [1 -1]) contrasts. This is that you are quite likely to only want to check for A&gt;B if both are positive. Don't forget that if both A and B are negative then this contrast could still come out significantly positive! In this case, the thing to do is to use the <strong>Contrast masking</strong> feature (see below); setup contrasts for the individual EVs and then mask the differential contrast with these. <span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><p class="line867">
<h3 id="F-tests">F-tests</h3>
<span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line874">F-tests enable you to investigate several contrasts at the same time, for example to see whether any of them (or any combination of them) is significantly non-zero. Also, the F-test allows you to compare the contribution of each contrast to the model and decide on significant and non-significant ones. F-tests are non-directional (i.e. test for &quot;positive&quot; and &quot;negative&quot; activation). <span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><p class="line862">One example of F-test usage is if a particular stimulation is to be represented by several EVs, each with the same input function (e.g. square wave or custom timing) but all with different HRF convolutions - i.e. several <strong>basis functions</strong>. Putting all relevant resulting parameter estimates together into an F-test allows the complete fit to be tested against zero without having to specify the relative weights of the basis functions (as one would need to do with a single contrast). So - if you had three basis functions (EVs 1,2 and 3) the wrong way of combining them is a single (T-test) contrast of [1 1 1]. The right way is to make three contrasts [1 0 0] [0 1 0] and [0 0 1] and enter all three contrasts into an F-test. As described above, FEAT will automatically do this for you if you set up contrasts for <strong>original EVs</strong> instead of <strong>real EVs</strong>. <span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><p class="line874">You can carry out as many F-tests as you like. Each test includes the particular contrasts that you specify by clicking on the appropriate buttons. <span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><p class="line867">
<h3 id="Buttons">Buttons</h3>
<span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line862">To view the current state of the design matrix, press <strong>View design</strong>. This is a graphical representation of the design matrix and parameter contrasts. The bar on the left is a representation of time, which starts at the top and points downwards. The white marks show the position of every 10th volume in time. The red bar shows the period of the longest temporal cycle which was passed by the highpass filtering. The main top part shows the design matrix; time is represented on the vertical axis and each column is a different (real) explanatory variable (e.g., stimulus type). Both the red lines and the black-white images represent the same thing - the variation of the waveform in time. Below this is shown the requested contrasts; each row is a different contrast vector and each column refers to the weighting of the relevant explanatory variable. Thus each row will result in a Z statistic image. If F-tests have been specified, these appear to the right of the contrasts; each column is a different F-test, with the inclusion of particular contrasts depicted by filled squares instead of empty ones. <span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><p class="line862">If you press <strong>Efficiency</strong> you will see a graphical representation of the covariance of the design matrix and the efficiency of the design/contrasts. Of most practical importance are the values in the lower part of the window, showing the estimability of the contrasts. <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><p class="line874">The first matrix shows the absolute value of the normalised correlation of each EV with each EV. If a design is well-conditioned (i.e. not approaching rank deficiency) then the diagonal elements should be white and all others darker. So - if there are any very bright elements off the diagonal, you can immediately tell which EVs are too similar to each other - for example, if element [1,3] (and [3,1]) is bright then columns 1 and 3 in the design matrix are possibly too similar. Note that this includes all real EVs, including any added temporal derivatives, basis functions, etc. The second matrix shows a similar thing after the design matrix has been run through SVD (singular value decomposition). All non-diagonal elements will be zero and the diagonal elements are given by the eigenvalues of the SVD, so that a poorly-conditioned design is obvious if any of the diagonal elements are black. <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><p class="line862">In the lower part of the window, for each requested contrast, that contrast's efficiency/estimability is shown. This is formulated as the strength of the signal required in order to detect a statistically significant result for this contrast. For example, in FMRI data and with a single regressor, this shows the BOLD % signal change required. In the case of a differential contrast, it shows the required difference in BOLD signal between conditions. This <strong>Effect Required</strong> depends on the design matrix, the contrast values, the statistical significance level chosen, and the noise level in the data (see the <strong>Misc</strong> tab in the main FEAT GUI). The lower the effect required, the more easily estimable is a contrast, i.e. the more efficient is the design. Note that this does not tell you everything that there is to know about paradigm optimisation. For example, all things being equal, event-related designs tend to give a smaller BOLD effect than block designs - the efficiency estimation made here cannot take that kind of effect into account! <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><p class="line862">When you have finished setting up the design matrix, press <strong>Done</strong>. This will dismiss the GLM GUI, and will give you a final view of the design matrix.  <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><p class="line867">
<h2 id="Contrasts.2C_Thresholding.2C_Rendering">Contrasts, Thresholding, Rendering</h2>
<span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><p class="line862">If you are not carrying out a <strong>Full analysis</strong> and are re-running <strong>Post-stats</strong>, a button appears to allow you to <strong>Edit contrasts</strong>. This allows setup of contrasts and F-tests, to be run on the previous analysis. <span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><p class="line862">If you choose a mask for <strong>Pre-threshold masking</strong> then all stats images will be masked by the chosen mask before thresholding. There are two reasons why you might want to do this. The first is that you might want to constrain your search for activation to a particular area. The second is that in doing so, you are reducing the number of voxels tested and therefore will make any multiple-comparison-correction in the thresholding less stringent. The mask image chosen does not have to be a binary mask - for example, it can be a thresholded stats image from a previous analysis (in the same space as the data to be analysed here); only voxels containing zero in the <strong>mask</strong> image will get zeroed in this masking process. If pre-threshold masking is used, it is still necessary to carry out thresholding. <span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><p class="line867"><strong>Thresholding</strong>: After carrying out the initial statistical test, the resulting Z statistic image is then normally thresholded to show which voxels or clusters of voxels are activated at a particular significance level. <span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><p class="line862">If <strong>Cluster</strong> thresholding is selected, a Z statistic threshold is used to define contiguous clusters. Then each cluster's estimated significance level (from GRF-theory) is compared with the cluster probability threshold. Significant clusters are then used to mask the original Z statistic image for later production of colour blobs. This method of thresholding is an alternative to <strong>Voxel</strong>-based correction, and is normally more sensitive to activation. You may well want to increase the cluster creation <strong>Z threshold</strong> if you have high levels of activation. <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><p class="line874">The FEAT web page report includes a table of cluster details, viewed by clicking on the relevant colour-overlay image. Note that cluster p-values are not given for contrasts where post-threshold contrast masking (see below) is applied, as there is not a sensible p-value associated with the new clusters formed after masking. <span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><p class="line862">If <strong>Voxel</strong> thresholding is selected, GRF-theory-based maximum height thresholding is carried out, with thresholding at the level set, using one-tailed testing. This test is less overly-conservative than Bonferroni correction. <span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><p class="line874">You can also choose to simply threshold the uncorrected Z statistic values, or apply no thresholding at all. <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line867"><strong>Contrast masking</strong>: You can setup the masking of contrasts by other contrasts; after thresholding of all contrasts has taken place you can further <strong>threshold</strong> a given Z statistic image by masking it with non-zeroed voxels from other contrasts. <span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><p class="line874">This means that of the voxels which passed thresholding in the contrast (or F-test) of interest, only those which also survived thresholding in the other contrasts (or F-tests) are kept. <span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><p class="line874">As a further option, the generated masks can be derived from all positive Z statistic voxels in the mask contrasts rather than all voxels that survived thresholding. <span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><p class="line867"><strong>Rendering</strong>: The Z statistic range selected for rendering is automatically calculated by default, to run from red (minimum Z statistic after thresholding) to yellow (maximum Z statistic). If more than one colour rendered image is to be produced (i.e., when multiple constrasts are created) then the overall range of Z values is automatically found from all of the Z statistic images, for consistent Z statistic colour-coding. <span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><p class="line862">If multiple analyses are to be carried out separately, <strong>Use preset Z min/max</strong> should be chosen, and the min/max values set by hand. Again, this ensures consistency of Z statistic colour-coding - if several experiments are to be reported side-by-side, colours will refer to the same Z statistic values in each picture. When using this option, you should choose a conservatively wide range for the min and max (e.g., min=1, max=15), to make sure that you do not carry out unintentional thresholding via colour rendering. <span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><p class="line862">With <strong>Solid colours</strong> you don't see any sign of the background images within the colour blobs; with <strong>Transparent colours</strong> you will see through the colour blobs to the background intensity. <span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span><p class="line862">If you are running a <strong>Higher-level analysis</strong> you can select what image will be used as the background image for the activation colour overlays. The default of <strong>Mean highres</strong> is probably the best for relating activation to underlying structure. For a sharper underlying image, (but one which is not so representative of the group of subjects), you can instead choose to use the highres image from the first selected subject. You can alternatively choose to use the original lowres functional data for the overlays, or the standard-space template image.  <span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><p class="line867">
<h2 id="Registration">Registration</h2>
<span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><p class="line874">Before any multi-session or multi-subject analyses can be carried out, the different sessions need to be registered to each other. This is made easy with FEAT, by saving the appropriate transformations inside the FEAT directories; the transformations are then applied when group statistics is carried out, to tranform any relevant statistic images into the common space. By doing this (saving the relevant registration transformations and only applying them to the stats images later) a lot of disk space is saved. <span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><p class="line862">Registration inside FEAT uses <a href="./FLIRT.html">FLIRT</a> (FMRIB's Linear Image Registration Tool). This is a very robust affine registration program which can register similar type images (intra-modal) or different types (inter-modal). Optionally, the structural to standard space registration can then be further refined by using <a href="./FNIRT.html">FNIRT</a>(FMRIB's Nonlinear Image Registration Tool), a fast and accurate nonlinear registration program. <span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><p class="line874">Typically, registration in FEAT is a two-stage process. First an example FMRI low resolution image is registered to an example high resolution image (often the same subject's T1-weighted structural). The transformation for this is saved into the FEAT directory. Then the high res image is registered to a standard image (normally a T1-weighted image in standard space, such as the MNI 152 average image). This transformation, also, is saved. Finally, the two transformations are combined into a third, which will take the low resolution FMRI images (and the statistic images derived from the first-level analyses) straight into standard space, when applied later, during group analysis. <span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><p class="line862">You can carry out registration for each first-level analysis at the same time as the original analysis, or get FEAT to &quot;register&quot; a pre-existing FEAT directory, at a later time. In the latter case, change the <strong>Full analysis</strong> to <strong>Registration</strong> only. <span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><p class="line862">The <strong>Initial structural</strong> image is the high resolution structural image which the low resolution functional data will be registered to, and this in turn will be registered to the main highres image. It only makes sense to have this initial highres image if a main highres image is also specified and used in the registration. <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><p class="line874">One example of an initial highres structural image might be a medium-quality structural scan taken during a day's scanning, if a higher-quality image has been previously taken for the subject. A second example might be a full-brain image with the same MR sequence as the functional data, useful if the actual functional data is only partial-brain. It is strongly recommended that this image have non-brain structures already removed, for example by using BET. <span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><p class="line874">If the field-of-view of the functional data (in any direction) is less than 120mm, then the registration of the functional data will by default have a reduced degree-of-freedom, for registration stability. <span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><p class="line862">If you are attempting to register partial field-of-view functional data to a whole-brain image then <strong>3 DOF</strong> is recommended - in this case only translations are allowed. <span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><p class="line874">If the orientation of any image is different from any other image it may be necessary to change the search to Full search. <span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><p class="line862">The <strong>Main structural image</strong> is is the main high resolution structural image which the low resolution functional data will be registered to (optionally via the <strong>initial structural image</strong>), and this in turn will be registered to the standard brain. It is strongly recommended that this image have non-brain structures already removed, for example by using BET. <span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><p class="line867"><strong>Standard space</strong> refers to the standard (reference) image; it should be an image already in standard space, ideally with the non-brain structures already removed. <span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><p class="line862">If you turn on <strong>Nonlinear</strong> then FNIRT will be used to apply nonlinear registration between the subject's structural image and standard space. FLIRT will still be used before FNIRT, to initialise the nonlinear registration. Nonlinear registration only works well between structural images and standard space; you cannot use it without specifying a structural image. FNIRT requires whole head (non-brain-extracted) input and reference images for optimal accuracy; if you turn on nonlinear registration, FEAT will look for the original non-brain-extracted structural and standard space images in the same directory as the brain-extracted images that you input into the GUI, these non-brain extracted images should have the same filename as the brain-extracted version appended with \&quot;_brain\&quot; at the end. It will complain if it can't find these, and if this is not corrected, nonlinear registration will run using the brain-extracted images, which is suboptimal. The <strong>Warp resolution</strong> controls the degrees-of-freedom (amount of fine detail) in the nonlinear warp; it refers to the spacing between the warp field control points. By increasing this you will get a smoother (&quot;less nonlinear&quot;) warp field and vice versa.  <span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><p class="line867">
<h2 id="Bottom_Row_of_Buttons">Bottom Row of Buttons</h2>
<span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><p class="line862">When you have finished setting up FEAT, press <strong>Go</strong> to run the analysis. Once FEAT is running, you can either Exit the GUI, or setup further analyses. <span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><p class="line862">The <strong>Save</strong> and <strong>Load</strong> buttons enable you to save and load the complete FEAT setup to and from file. The filename should normally be chosen as design.fsf - this is also the name which FEAT uses to automatically save the setup inside a FEAT directory. Thus you can load in the setup that was used on old analyses by loading in this file from old FEAT directories. <span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><p class="line862">The <strong>Utils</strong> button produces a menu of FEAT-related utilities: <span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><ul><li><p class="line891"><strong>Load FEAT results into MEDx</strong> (only seen if FEAT is run from within MEDx). This opens a new folder and loads in results from a FEAT directory, setting up each stats image to be &quot;time series clickable&quot;. <span class="anchor" id="line-157"></span></li><li><p class="line891"><a href="./FEAT(2f)GuideStats.html#Featquery_-_FEAT_Results_Interrogation">Featquery</a> is a program which allows you to interrogate FEAT results by defining a mask or set of co-ordinates (in standard-space, highres-space or loweres-space) and get mean stats values and time-series. <span class="anchor" id="line-158"></span></li><li><p class="line891"><a class="nonexistent" href="./MISCVIS.html">Simple stats colour rendering</a> allows you to overlay one or two stats images on a background image of the same size. <span class="anchor" id="line-159"></span></li><li><p class="line891"><strong>Colour render FEAT stats in high res</strong> produces colour rendered stats images in a selected FEAT directory, using either the original high resolution structural image as the background, or the structural image transformed into standard space as the background. This script starts by transforming stats into high resolution space and then produces 3D colour overlay images. 2D pictures of these are then saved to file and the 3D files removed to save disk space, but this removal can be turned off in the GUI. <span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span></li></ul><p class="line867">
<h2 id="Time-Series_Plots">Time-Series Plots</h2>
<span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><p class="line874">FEAT generates a set of time-series plots for data vs model for peak Z voxels. The main FEAT report web page contains a single plot for each contrast (from the peak voxel); clicking on this takes you to more plots related to that contrast, including also, in the case of cluster-based thresholding, plots averaged over all significant voxels. <span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><p class="line862">Plots of <strong>full model fit</strong> vs <strong>data</strong> show the original data and the complete model fit given by the GLM analysis. <span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><p class="line862">Plots of <strong>cope partial model fit</strong> vs <strong>reduced data</strong> show the model fit due simply to the contrast of interest versus that part of the data which is relevant to the reduced model (i.e. full data minus full model plus cope partial model). This generally is only easily interpretable in the case of simple non-differential contrasts. <span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><p class="line867"><strong>Peri-stimulus plots</strong> show the same plots as described above but averaged over all &quot;repeats&quot; of events, whether ON-OFF blocks in a block-design, or events in an event-related design. Thus you get to see the average response shape. Note that FEAT tries to guess what an &quot;event&quot; is in your design automatically, so in complex designs this can give somewhat strange looking plots! The peri-stimulus plots are for the peak voxel only; one pair of full/partial plots is produced for each EV in the design matrix for that peak voxel, with the &quot;events&quot; defined from that EV only.  <span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><p class="line867">
<h2 id="Group_Statistics">Group Statistics</h2>
<span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><p class="line867">
<h3 id="Background_and_Theory">Background and Theory</h3>
<span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><p class="line862">For higher-level analysis (e.g. analysis across sessions or across subjects) FEAT uses FLAME (FMRIB's Local Analysis of Mixed Effects). FLAME uses sophisticated methods for modelling <a class="http" href="http://www.fmrib.ox.ac.uk/analysis/techrep/index.html#TR01CB1">(see related techreport TR01CB1)</a> and estimating the inter-session or inter-subject random-effects component of the mixed-effects variance, by using MCMC to get an accurate estimation of the true random-effects variance and degrees of freedom at each voxel <a class="http" href="http://www.fmrib.ox.ac.uk/analysis/techrep/index.html#TR03MW1">(see related techreport TR03MW1)</a>. <span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><p class="line874">FEAT offers both fixed effects (FE) and mixed effects (ME) higher-level modelling. FE modelling is more &quot;sensitive&quot; to activation than ME, but is restricted in the inferences that can be made from its results; because FE ignores cross-session/subject variance, reported activation is with respect to the group of sessions or subjects present, and not representative of the wider population. ME does model the session/subject variability, and it therefore allows inference to be made about the wider population from which the sessions/subjects were drawn. <span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span><p class="line874">The remainder of this section discusses FLAME's mixed effects modelling. <span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><p class="line874">&quot;Mixed-effects&quot; (ME) variance is the sum of &quot;fixed-effects&quot; (FE) variance (the within-session across-time variances estimated in the first-level analyses) and &quot;random-effects&quot; (RE) variance (the &quot;true&quot; cross-session variances of first-level parameter estimates). Note that the labels &quot;mixed effects&quot; and &quot;random effects&quot; are often (incorrectly) used interchangeably, partly because they are in practice often (but, importantly, not always) quite similar. <span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><p class="line874">One factor that makes FEAT's approach to higher-level modelling particularly powerful is that it is easy to model and estimate different variances for different groups in the model. For example, an unpaired two-group comparison (e.g. between controls and patients) can be analysed with separate estimates of variance for each group. It is simply a case of specifying in the GUI what group each subject belongs to. (Note - FLAME does not model different group variances differently in the case of higher-level F-tests, due to the complexity of the resulting distributions; this may be addressed in the future.) <span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><p class="line874">A second sophistication not normally available in multi-level analyses is the carrying-up of the first-level (FE) variances to the higher-level analyses. This means that the FE component of the higher-level ME variance can be taken into account when attempting to estimate the ME variance. One reason why it is suboptimal to simply use the directly-estimated ME variance is that this is often in practice lower than the estimated FE variance, a logical impossibility which implies negative RE variance. FEAT forces the RE variance in effect to be non-negative, giving a better estimate of ME variance. <span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><p class="line874">Another reason for wanting to carry up first-level variances to the higher-level analyses is that it is not then necessary for first-level design matrices to be identical (ie &quot;balanced designs&quot; - for example having the same number of time points or event timings). (Note though: the &quot;height&quot; of design matrix waveforms at first-level must still be compatible across analyses.) <span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><p class="line874">A third advantage in higher-level analysis with FEAT is that it is not necessary for different groups to have the same number of subjects (another aspect to design balancing) for the statistics to be valid, because of the ability to model different variances in different groups. <span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><p class="line874">The higher-level estimation method in FEAT (FLAME) uses the above modelling theory and estimates the higher-level parameter estimates and ME variance using sophisticated estimation techniques. First, the higher-level model is fit using a fast approximation to the final estimation (&quot;FLAME stage 1&quot;). Then, all voxels which are close to threshold (according to the selected contrasts and thresholds) are processed with a much more sophisticated estimation process involving implicit estimation of the ME variance, using MH MCMC (Metropolis-Hastings Markov Chain Monte Carlo sampling) to give the distribution for higher-level contrasts of parameter estimates, to which a general t-distribution is then fit. Hypothesis testing can then be carried out on the fitted t-distribution to give inference based upon the best implicit estimation of the ME variance. <span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><p class="line867">
<h3 id="FE_and_Within-Subject_Multi-Session_Analysis">FE and Within-Subject Multi-Session Analysis</h3>
<span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><p class="line874">One use of the fixed-effects option is for combining multi-session analyses within-subject. <span class="anchor" id="line-196"></span>You may want to change the normal way of running registration at single-level, if you would rather do the FE analysis at the resolution of the subject's structural MR image, and overlay the multi-session FE activation on this. To do this, when running first-level registrations, turn off the <strong>Main structural image</strong> option and select the (brain-extracted) structural image as <strong>Standard space</strong>. <span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><p class="line874">Note that if you also want to feed the first-level data into multi-subject analyses, you will then want to redo the (first-level) registrations in the normal way. <span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><p class="line867">
<h3 id="Setting_Up_Higher-Level_Analysis_in_FEAT">Setting Up Higher-Level Analysis in FEAT</h3>
<span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><p class="line862">For figures showing the file and directory structures for first- and second-level FEAT analyses, see the <a href="./FEAT(2f)GuideStats.html#Output">Output</a> section. <span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><p class="line862">First change <strong>First-level analysis</strong> to <strong>Higher-level analysis</strong>. Note that the only processing option available is <strong>Stats + Post-stats</strong>; this is because at higher-level both <strong>Stats</strong> and <strong>Post-stats</strong> always need setting up, as the thresholding to be carried out affects the functioning of the core stats estimation. For the same reason it is not possible to re-threshold a higher-level analysis - the whole higher-level analysis must be re-run. <span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><p class="line862">You can choose whether your higher-level design matrix will be applied to a set of <strong>lower-level cope images</strong> or a set of <strong>lower-level FEAT directories</strong>. In the latter, more normal, case, each contrast in the lower-level FEAT directories will have the higher-level model applied, each resulting in its own FEAT directory within the new group FEAT directory. <span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><p class="line862">Now set the <strong>Number of analyses</strong> and <strong>Select FEAT directories</strong> (the first-level FEAT analyses to be fed into this higher-level analysis). FEAT will produce a new directory containing the group stats results; unless you specify an output directory name, the output directory name will be derived from the name of the first selected first-level FEAT directory. The suffix .gfeat is used. <span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><p class="line862">Now setup the <strong>Stats</strong>. The main choice here is between fixed effects (FE) and mixed effects (ME) higher-level modelling. FE modelling is more &quot;sensitive&quot; to activation than ME, but is restricted in the inferences that can be made from its results; because FE ignores cross-session/subject variance, reported activation is with respect to the group of sessions or subjects present, and not representative of the wider population. ME does model the session/subject variability, and it therefore allows inference to be made about the wider population from which the sessions/subjects were drawn. <span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><p class="line874">The FE option implements a standard weighted fixed effects model. No random effects variances are modelled or estimated. The FE error variances are the variances (varcopes) from the previous level. Weighting is introduced by allowing these variances to be unequal (heteroscedastic). Degrees-of-freedom are calculated by summing the effective degrees-of-freedom for each input from the previous level and subtracting the number of higher-level regressors. <span class="anchor" id="line-213"></span><span class="anchor" id="line-214"></span><p class="line874">We now discuss the different ME options. <span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span><p class="line874">OLS (ordinary least squares) is a fast estimation technique which ignores all lower-level variance estimation and applies a very simple higher-level model. This is the least accurate of the ME options. <span class="anchor" id="line-217"></span><span class="anchor" id="line-218"></span><p class="line874">For the most accurate estimation of higher-level activation you should use FLAME (FMRIB's Local Analysis of Mixed Effects) modelling and estimation. This is a sophisticated two-stage process using Bayesian modelling and estimation (for example it allows separate modelling of the variance in different subject groups, and forces random effects variance to be non-negative). <span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span><p class="line874">The first stage of FLAME is significantly more accurate than OLS, and nearly as fast. The second stage of FLAME increases accuracy slightly over the first stage, but is quite a lot slower (typically 45-200 minutes). It takes all voxels which FLAME stage 1 shows to be near threshold and carries out a full MCMC-based analysis at these points, to get the most accurate estimate of activation. <span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span><p class="line862">We generally recommend using <strong>FLAME 1</strong>, as it is MUCH faster than running both stages, and nearly as accurate. The added value from running full <strong>FLAME 1+2</strong> is most significant in a highest-level analysis when you have a small number of subjects (say &lt;10). <span class="anchor" id="line-223"></span><span class="anchor" id="line-224"></span><p class="line862">If you are carrying out a mid-level analysis (e.g., cross-sessions) and will be feeding this into an even higher-level analysis (e.g., cross-subjects), then you should not use the <strong>FLAME 1+2</strong> option, as it is not possible for FLAME to know in advance of the highest-level analysis what voxels will ultimately be near threshold. With respect the question of whether to use fixed-effects or mixed-effects for such mid-level analyses, it could be argued that a mixed-effects analysis should be done at the mid-level. A mixed-effects analysis would assume that the sessions are randomly sampled from a &quot;population&quot; of sessions that that subject could produce. This includes estimation of each subject's session-to-session variance. However, it is common for only a small number of sessions to be collected for each subject, making estimation of each subject's session-to-session variance impractical. One solution to this is to assume a common session-to-session variance for all subjects, thereby providing enough data for the session-to-session variance to be estimated. However, this has a downside in that you lose information about which subjects are good (i.e. low variance) and which subjects are bad (i.e. high variance). Hence, when only a small number of sessions has been collected for each subject (say, less than 10), it is recommended that you use a fixed-effects analysis at the mid-level. This in effect treats the multiple first-level sessions (for each subject) as if they were one long session. Although this does ignore the session-session variability, it is arguable that this is not of interest anyway (this is a somewhat philosophical debate). In short, fixed-effects is favoured as it avoids practical problems associated with esimating the session-to-session variance (when there are not many sessions per subject), at the same time as maintaining information about which subjects are good and bad. <span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><p class="line862">If you do decide to run <strong>FLAME 1+2</strong> and the FEAT logs indicate a large difference between the stage 1 and stage 2 estimations (or, for example, the final thresholded zstat image looks &quot;speckled&quot;), this is an indication that your data is highly non-Gaussian (e.g., has one or more strong outlier subjects, or has two clearly different groups of subjects being modelled as a single group). In such a case, stage 1 estimation is quite inaccurate (OLS even more so), hence the larger-than-normal difference between stages 1 and 2. The only really good solution is to investigate in your data what is going on - for example, to find the bad outlier. <span class="anchor" id="line-227"></span><span class="anchor" id="line-228"></span><p class="line862">If you turn on <strong>Use automatic outlier de-weighting</strong> then FLAME will automatically detect outlier datapoints (for each voxel, each subject's data is considered with respect to the other subjects regarding whether it appears to be an outlier) [Woolrich M (2008), <a class="nonexistent" href="./NeuroImage.html">NeuroImage</a> 41(2)]. Outliers are then automatically de-weighted in the multi-subject statistics. Outlier de-weighting is only available for the mixed effects options as it doesn't make sense in the context of a fixed effects model. It inceases the computation time considerably. The estimated outlier behaviour is stored in the <strong>stats</strong> directory found inside the higher-level FEAT directory. The prob_outlier1.nii.gz file is a 4D file giving the probability that each subject has outlier data on a voxelwise basis. The global_prob_outlier1.nii.gz file is a 3D file that indicates the size of the outlier population expressed as the proportion of subjects that are outliers (see the paper for more details). Note there are versions of these files for each variance group in the analysis. <span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><p class="line862">For certain higher-level design types you can use the &quot;wizard&quot; - press the <strong>Model setup wizard</strong> button. Then choose whether to setup <strong>single group average</strong> or <strong>two groups, unpaired</strong> or <strong>two groups, paired designs</strong>. In the case of the unpaired two-group test, set the number of subjects in the first group. When you then press <strong>Process</strong> the design will be setup for you. <span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><p class="line862">Next go to the full model setup. First choose the <strong>Number of EVs</strong> (different effects to be modelled). Next, the <strong>Number of groups</strong> is the number of different groups (of lower-level sessions or subjects). If you ask for more than one group, each group will end up with a separate estimate of variance for the higher-level parameter estimates; for example, if the first 10 inputs are first-level FEAT outputs from control subjects and the next 10 inputs are first-level FEAT outputs from patients, you can setup two different groups and each will end up with its own variance estimates, possibly improving the final modelling and estimation quality (see examples below for further clarification). If you setup different groups for different variances, you will get fewer data-points to estimate each variance (than if only one variance was estimated). Therefore, you only want to use this option if you do believe that the groups possibly do have different variances. If you setup different groups for different variances, it is necessary that, for each EV, only one of the sub-groups has non-zero values. Thus, for example, in the case of an unpaired t-test: <span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><span class="anchor" id="line-235"></span><span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><pre><span class="anchor" id="line-1"></span>GP EV1 EV2
<span class="anchor" id="line-2"></span>1   1    1 
<span class="anchor" id="line-3"></span>1   1    1 
<span class="anchor" id="line-4"></span>1   1    1 
<span class="anchor" id="line-5"></span>1   1    1 
<span class="anchor" id="line-6"></span>2   1   -1
<span class="anchor" id="line-7"></span>2   1   -1
<span class="anchor" id="line-8"></span>2   1   -1</pre><span class="anchor" id="line-243"></span><p class="line874">is wrong with respect to this issue, and the following is correct: <span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span><span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><span class="anchor" id="line-253"></span><pre><span class="anchor" id="line-1-1"></span>GP EV1 EV2
<span class="anchor" id="line-2-1"></span>1   1    0 
<span class="anchor" id="line-3-1"></span>1   1    0 
<span class="anchor" id="line-4-1"></span>1   1    0 
<span class="anchor" id="line-5-1"></span>1   1    0 
<span class="anchor" id="line-6-1"></span>2   0    1
<span class="anchor" id="line-7-1"></span>2   0    1
<span class="anchor" id="line-8-1"></span>2   0    1</pre><span class="anchor" id="line-254"></span><p class="line874">Unlike with first-level analyses, the data (and the model) does not get demeaned. This is because mean effects are usually of interest! One effect of this is that a two-group unpaired model needs 2 EVs - one for finding each group's mean; it will not work to have a single EV containing 1's and -1's. <span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><p class="line862">Setting the <strong>Number of additional, voxel-dependent EVs</strong> allows you to add voxel-dependent EVs; every voxel will have a different higher-level model. For each additional EV that you ask for, you will need to provide the filename of a 4D image file whose first 3 dimensions are the size of standard space, and whose 4th dimension corresponds to the number of sessions/subjects that you are inputting into this higher-level analysis. A typical use of voxel-dependent EVs would be to <a class="http" href="http://dx.doi.org/10.1016/j.neuroimage.2006.10.007">insert grey-matter partial volume information on the basis of structural imaging</a>. Note that when you use this option and view the design matrix, a voxel-dependent EV is respresented graphically by the mean EV across all voxels, which may well not be very meaningful. If you want to use structural images (as used in the first-level FEAT registrations) to create the covariates, then you can easily generate the 4D covariate image with the <tt class="backtick">feat_gm_prepare</tt> script; just type the script name followed by the desired 4D output image name and then the full list of first-level FEAT directories (these must be in the same order as they will appear as inputs to the higher-level FEAT analysis). You should run this script after all the first-level FEAT analyses and before running the higher-level FEAT. <span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><p class="line862">Now setup the required <strong>Contrasts &amp; F-tests</strong> and <strong>Post-stats</strong> (see examples below). <span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><p class="line874">The higher-level design matrix is applied separately to each of the lower-level contrasts; thus each lower-level contrast will result in a new FEAT directory within the new top-level group FEAT directory. When FEAT has completed the higher-level analyses the new top-level group FEAT output directory contains a web page report which contains: a link to each of the original lower-level FEAT directories; a link to each of the higher-level FEAT analyses (one for each lower-level contrast); the picture of the higher-level design matrix. <span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span><p class="line874">We now give specific examples of how to set up the most common high-level analyses.  <span class="anchor" id="line-263"></span><span class="anchor" id="line-264"></span><p class="line867">
<h3 id="Single-Group_Average_.28One-Sample_T-Test.29">Single-Group Average (One-Sample T-Test)</h3>
<span class="anchor" id="line-265"></span><span class="anchor" id="line-266"></span><p class="line874">We have 8 subjects all in one group and want the mean group effect. Does the group activate on average? <span class="anchor" id="line-267"></span><span class="anchor" id="line-268"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg1.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-269"></span><span class="anchor" id="line-270"></span><p class="line867">
<h3 id="Unpaired_Two-Group_Difference_.28Two-Sample_Unpaired_T-Test.29">Unpaired Two-Group Difference (Two-Sample Unpaired T-Test)</h3>
<span class="anchor" id="line-271"></span><span class="anchor" id="line-272"></span><p class="line874">We have two groups of different kinds of subjects (eg 9 patients and 7 controls) with potentially different cross-subject variance in the different groups , so we will specifiy two group &quot;memberships&quot; so that FEAT estimates each group's cross-subject variance separately. We want the mean group difference, and will look in both directions, hence the two contrasts. Note that we cannot setup this model with a single EV (see above). <span class="anchor" id="line-273"></span><span class="anchor" id="line-274"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg2.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-275"></span><span class="anchor" id="line-276"></span><p class="line867">
<h3 id="Paired_Two-Group_Difference_.28Two-Sample_Paired_T-Test.29">Paired Two-Group Difference (Two-Sample Paired T-Test)</h3>
<span class="anchor" id="line-277"></span><span class="anchor" id="line-278"></span><p class="line874">We have a group of 8 subjects scanned under two different conditions, A and B. We enter the condition A analyses as the first 8 inputs, and the condition B analyses as the second 8 inputs. Make sure that the subjects are in the same order within each group of 8! We need one EV for the A-B differences, and then one extra EV for each subject, making 9 in all. EVs 2-9 model each subject's mean effect - in this analysis this is a confound, i.e. parameter estimates 2-9 are ignored, but without this part of the model, the mean effects would intefere with the estimation of the A-B paired differences. A contrast with a one for EV1 and zeros elsewhere tests for A-B paired differences. <span class="anchor" id="line-279"></span><span class="anchor" id="line-280"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg3.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-281"></span><span class="anchor" id="line-282"></span><p class="line867">
<h3 id="Tripled_Two-Group_Difference_.28.22Tripled.22_T-Test.29">Tripled Two-Group Difference (&quot;Tripled&quot; T-Test)</h3>
<span class="anchor" id="line-283"></span><span class="anchor" id="line-284"></span><p class="line874">This is a natural extension of the paired t-test, but the contrasts are slightly counter-intuitive so we explain this case in detail. <span class="anchor" id="line-285"></span>We have 5 subjects, each scanned under 3 conditions, A, B and C. We enter the 5 condition A scans first, then 5 B and then 5 C. As with the paired t-test, EVs 3-7 simply remove the subject means and are not used in the contrasts. <span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><p class="line874">We now want to form the 3 contrasts A-B, A-C and B-C. Note that, somewhat surprisingly, A-B is not given by [1 0 0...]! <span class="anchor" id="line-288"></span>We define PE1=a and PE2=b. Then, we can see by looking at the three condition blocks, that the mean (on top of the global mean taken out by EVs 3-7) of condition A is modelled by A=a+b. Likewise, B=-a, and C=-b (look at the values in EVs 1 and 2). <span class="anchor" id="line-289"></span>Therefore we have A-B = 2a+b = contrast [ 2 1 0....], <span class="anchor" id="line-290"></span>and A-C = a+2b = contrast [ 1 2 0....], <span class="anchor" id="line-291"></span>and B-C = -a+b = contrast [ -1 1 0....]. <span class="anchor" id="line-292"></span><span class="anchor" id="line-293"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg3b.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-294"></span><span class="anchor" id="line-295"></span><p class="line867">
<h3 id="Multi-Session_.26_Multi-Subject_.28Repeated_Measures_-_Three_Level_Analysis.29">Multi-Session &amp; Multi-Subject (Repeated Measures - Three Level Analysis)</h3>
<span class="anchor" id="line-296"></span><span class="anchor" id="line-297"></span><p class="line874">5 subjects each have three sessions. For the reasons described above, we will combine across sessions to create COPEs for the subject means of each subject, using a fixed-effects analysis. In the stats GUI, we select Fixed effects. Then we setup the second-level analysis with 5 EVs, where each EV picks out the 3 sessions that correspond to a particular subject. We also need 5 contrasts to represent the 5 subject means, as follows: <span class="anchor" id="line-298"></span><span class="anchor" id="line-299"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg4a.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-300"></span><span class="anchor" id="line-301"></span><p class="line862">Now we want the mean group effect, across subjects, achieved with a third-level <strong>ME</strong> analysis. Select <strong>Inputs are lower-level FEAT directories</strong> and select the 5 relevant directories created at second-level, named something like subject_N.gfeat/cope1.feat. <span class="anchor" id="line-302"></span><span class="anchor" id="line-303"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg4b.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-304"></span><span class="anchor" id="line-305"></span><p class="line867">
<h3 id="F-Tests">F-Tests</h3>
<span class="anchor" id="line-306"></span><span class="anchor" id="line-307"></span><p class="line874">For example, three groups of subjects, with the question - is any group activating on average? <span class="anchor" id="line-308"></span><span class="anchor" id="line-309"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg5.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-310"></span><span class="anchor" id="line-311"></span><p class="line867">
<h3 id="Single-Group_Average_with_Additional_Covariate">Single-Group Average with Additional Covariate</h3>
<span class="anchor" id="line-312"></span><span class="anchor" id="line-313"></span><p class="line874">We have 7 subjects all in one group. We also have additional measurements such as age, disability scale or behavioural measures such as mean reaction times. The additional effect of the extra measures can be found by entering this as an extra EV which has been orthogonalised wrt the group mean EV - so in this case simply demeaned: <span class="anchor" id="line-314"></span><span class="anchor" id="line-315"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg6.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-316"></span><span class="anchor" id="line-317"></span><p class="line867">
<h3 id="ANOVA:_1-factor_4-levels">ANOVA: 1-factor 4-levels</h3>
<span class="anchor" id="line-318"></span><span class="anchor" id="line-319"></span><p class="line874">We have 8 subjects and 1 factor at 4 levels A, B, C and D. The first two inputs are subjects in condition A, the next two are B etc. <span class="anchor" id="line-320"></span><span class="anchor" id="line-321"></span><p class="line862">To compare a level with another we could just have one EV per level. However, if we want to ask the ANOVA question - where is there <strong>any</strong> treatment effect then we can do the following. EV1 fits condition D (it is the only nonzero EV during condition D). EV2 fits A relative to this, i.e. represents A-D (see below for explanation). The F-test then tests for any deviation - ie any difference between the levels, and corresponds exactly to the standard ANOVA test. <span class="anchor" id="line-322"></span><span class="anchor" id="line-323"></span><p class="line874">If, as well as the ANOVA test, you wanted to interpret individual contrasts: <span class="anchor" id="line-324"></span>If we define m,a,b,c as the 4 PE values, then<br>
 <span class="anchor" id="line-325"></span>A=a+m, B=b+m, C=c+m, D=m.<br>
 <span class="anchor" id="line-326"></span>Thus the first PE, m, is level D, the second is a=A-m=A-D, etc.<br>
 <span class="anchor" id="line-327"></span>To get the mean: mean = (A+B+C+D)/4 = m+(a+b+c)/4 = contrast [ 1 1/4 1/4 1/4 ]<br>
 <span class="anchor" id="line-328"></span>To get A-mean: A-mean = (3a-b-c)/4 = contrast [ 0 3/4 -1/4 -1/4 ] etc.<br>
 <span class="anchor" id="line-329"></span>To get D-mean: D-mean = (-a-b-c)/4 = contrast [ 0 -1/4 -1/4 -1/4 ]. <span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg7.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-332"></span><span class="anchor" id="line-333"></span><p class="line867">
<h3 id="ANOVA:_1-factor_4-levels_.28Repeated_Measures.29">ANOVA: 1-factor 4-levels (Repeated Measures)</h3>
<span class="anchor" id="line-334"></span><span class="anchor" id="line-335"></span><p class="line874">We have 2 subjects with 1 factor at 4 levels; both subjects had sessions at all 4 levels. The design is the same as above, except that we replace EV1 (the global mean) with a separate mean EV for each subject. This decreases the degrees of freedom in the model, but removes the uninteresting subject-mean variability from the residuals. <span class="anchor" id="line-336"></span>This approach is analogous to the difference between the unpaired and paired two-group t-test examples shown above. For the other ANOVA examples below, it is similarly straightforward to replace the mean EV with multiple mean EVs in this manner, if you have more than one session per subject. <span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><p class="line874">Subject 1's 4 levels are Inputs 1,3,5,7 and subject 2's 4 levels are Inputs 2,4,6,8. <span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg7b.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-341"></span><span class="anchor" id="line-342"></span><span class="anchor" id="line-343"></span><p class="line867">
<h3 id="ANOVA:_2-factors_2-levels">ANOVA: 2-factors 2-levels</h3>
<span class="anchor" id="line-344"></span><span class="anchor" id="line-345"></span><p class="line867">
<h4 id="Fixed_Effects">Fixed Effects</h4>
<span class="anchor" id="line-346"></span><p class="line874">We have 8 subjects and 2 factors, each at 2 levels. To carry out a standard ANOVA we use the following, the three F-tests giving the standard ANOVA results for factor A, factor B and the interaction effect. This assumes that both factors are fixed effects. <span class="anchor" id="line-347"></span><span class="anchor" id="line-348"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg8.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-349"></span><span class="anchor" id="line-350"></span><p class="line867">
<h4 id="Random_Effects">Random Effects</h4>
<span class="anchor" id="line-351"></span><span class="anchor" id="line-352"></span><p class="line874">If both factors are random effects then the F-tests for the effects of the factors are different - the denominator in the F is derived from the interaction effect and not the within-cell errors. In this case, the relevant F images for factors A and B can be formed as Fa=fstat1/fstat3 and Fb=fstat2/fstat3. In order to carry this out, first run FEAT using the above design. Then: <span class="anchor" id="line-353"></span><span class="anchor" id="line-354"></span><p class="line867"><tt class="backtick">cd&nbsp;&lt;featdir&gt;/stats</tt> <span class="anchor" id="line-355"></span><span class="anchor" id="line-356"></span><p class="line867"><tt class="backtick">fslmaths&nbsp;fstat1&nbsp;-div&nbsp;fstat3&nbsp;fstata</tt><br>
 <span class="anchor" id="line-357"></span><tt class="backtick">fslmaths&nbsp;fstat2&nbsp;-div&nbsp;fstat3&nbsp;fstatb</tt> <span class="anchor" id="line-358"></span><span class="anchor" id="line-359"></span><p class="line867"><tt class="backtick">ftoz&nbsp;-zout&nbsp;zfstata&nbsp;fstata&nbsp;1&nbsp;1</tt><br>
 <span class="anchor" id="line-360"></span><tt class="backtick">ftoz&nbsp;-zout&nbsp;zfstatb&nbsp;fstatb&nbsp;1&nbsp;1</tt> <span class="anchor" id="line-361"></span><span class="anchor" id="line-362"></span><p class="line862">You could then do thresholding on zfstata and zfstatb with <tt class="backtick">easythresh</tt>. <span class="anchor" id="line-363"></span><span class="anchor" id="line-364"></span><p class="line867">
<h4 id="Mixed_Effects">Mixed Effects</h4>
<span class="anchor" id="line-365"></span><span class="anchor" id="line-366"></span><p class="line874">If one factor is random and the other is fixed then we want a mixed effects analysis. In this case the fstat which needs the different denominator is the one associated with the fixed factor. For example, if factor A is fixed and factor B is random, then fstat2 already gives you the effect of factor B and for factor A you need to create Fa=fstat1/fstat3 as above. <span class="anchor" id="line-367"></span><span class="anchor" id="line-368"></span><p class="line867">
<h3 id="ANOVA:_3-factors_2-levels">ANOVA: 3-factors 2-levels</h3>
<span class="anchor" id="line-369"></span><span class="anchor" id="line-370"></span><p class="line867">
<h4 id="Fixed_Effects-1">Fixed Effects</h4>
<span class="anchor" id="line-371"></span><p class="line874">We have 16 subjects and 3 factors, each at 2 levels. To carry out a standard ANOVA we use the following, the F-tests giving the standard ANOVA results for the factors and their interactions. <span class="anchor" id="line-372"></span><span class="anchor" id="line-373"></span><div><table><tbody><tr>  <td><p class="line891"><a class="nonexistent" href="" title="Upload new attachment &quot;eg9.png&quot;"><img alt="" height="32" src="/fsl/wiki_static/fsl/img/attach.png" title="" width="32" /></a></td>
</tr>
</tbody></table></div><span class="anchor" id="line-374"></span><span class="anchor" id="line-375"></span><p class="line867">
<h4 id="Random.2FMixed_Effects">Random/Mixed Effects</h4>
<span class="anchor" id="line-376"></span><span class="anchor" id="line-377"></span><p class="line874">The following table shows how to test for factor effects with various models: <span class="anchor" id="line-378"></span><span class="anchor" id="line-379"></span><div><table><tbody><tr>  <td><p class="line891"><strong>model</strong></td>
  <td><p class="line891"><strong>A</strong></td>
  <td><p class="line891"><strong>B</strong></td>
  <td><p class="line891"><strong>C</strong></td>
  <td><p class="line891"><strong>F(A)</strong></td>
  <td><p class="line891"><strong>F(B)</strong></td>
  <td><p class="line891"><strong>F(C)</strong></td>
  <td><p class="line891"><strong>F(AB)</strong></td>
  <td><p class="line891"><strong>F(AC)</strong></td>
  <td><p class="line891"><strong>F(BC)</strong></td>
  <td><p class="line891"><strong>F(ABC)</strong></td>
</tr>
<tr>  <td><span class="anchor" id="line-380"></span><p class="line862">1</td>
  <td><p class="line862">F</td>
  <td><p class="line862">F</td>
  <td><p class="line862">F</td>
  <td><p class="line862">fstat1</td>
  <td><p class="line862">fstat2</td>
  <td><p class="line862">fstat3</td>
  <td><p class="line862">fstat4</td>
  <td><p class="line862">fstat5</td>
  <td><p class="line862">fstat6</td>
  <td><p class="line862">fstat7</td>
</tr>
<tr>  <td><span class="anchor" id="line-381"></span><p class="line862">2</td>
  <td><p class="line862">R</td>
  <td><p class="line862">R</td>
  <td><p class="line862">R</td>
  <td><p class="line862"> </td>
  <td><p class="line862"> </td>
  <td><p class="line862"> </td>
  <td><p class="line862">fstat4/fstat7</td>
  <td><p class="line862">fstat5/fstat7</td>
  <td><p class="line862">fstat6/fstat7</td>
  <td><p class="line862">fstat7</td>
</tr>
<tr>  <td><span class="anchor" id="line-382"></span><p class="line862">3</td>
  <td><p class="line862">F</td>
  <td><p class="line862">R</td>
  <td><p class="line862">R</td>
  <td><p class="line862"> </td>
  <td><p class="line862">fstat2/fstat6</td>
  <td><p class="line862">fstat3/fstat6</td>
  <td><p class="line862">fstat4/fstat7</td>
  <td><p class="line862">fstat5/fstat7</td>
  <td><p class="line862">fstat6</td>
  <td><p class="line862">fstat7</td>
</tr>
<tr>  <td><span class="anchor" id="line-383"></span><p class="line862">4</td>
  <td><p class="line862">F</td>
  <td><p class="line862">F</td>
  <td><p class="line862">R</td>
  <td><p class="line862">fstat1/fstat5</td>
  <td><p class="line862">fstat2/fstat6</td>
  <td><p class="line862">fstat3</td>
  <td><p class="line862">fstat4/fstat7</td>
  <td><p class="line862">fstat5</td>
  <td><p class="line862">fstat6</td>
  <td><p class="line862">fstat7</td>
</tr>
</tbody></table></div><span class="anchor" id="line-384"></span><span class="anchor" id="line-385"></span><span class="anchor" id="line-386"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-387"></span><a href="./CategoryFEAT.html">CategoryFEAT</a> <span class="anchor" id="line-388"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2017-04-20 13:28
</body>
</html>
